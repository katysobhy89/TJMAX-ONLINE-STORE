// Initialize the shopping cart
let cart = [];

// Function to add item to cart
function addToCart(productId, quantity) {
    const product = products.find(p => p.id === productId);

    // Check if user is logged in
    if (!isLoggedIn()) {
        alert('Please log in to add items to your cart.');
        return;
    }

    // Check stock availability
    if (product.stock === 0) {
        alert('This item is out of stock.');
        return;
    }

    // Validate quantity
    if (quantity <= 0) {
        alert('Quantity must be a positive number.');
        return;
    }

    // Add or update the item in the cart
    const cartItem = cart.find(item => item.id === productId);
    if (cartItem) {
        cartItem.quantity += quantity;
    } else {
        cart.push({ ...product, quantity });
    }

    // Update stock
    product.stock -= quantity;
    alert('Item added to cart!');
}

// Function to remove item from cart
function removeFromCart(productId) {
    cart = cart.filter(item => item.id !== productId);
    alert('Item removed from cart!');
}

// Function to modify item quantity in the cart
function modifyItemQuantity(productId, newQuantity) {
    const cartItem = cart.find(item => item.id === productId);

    // Check for negative quantity
    if (newQuantity < 0) {
        alert('Quantity must be a positive number.');
        return;
    }

    if (cartItem) {
        // Update quantity
        const difference = newQuantity - cartItem.quantity;
        const product = products.find(p => p.id === productId);
        
        // Check stock availability
        if (difference > product.stock) {
            alert('Not enough stock available to fulfill this request.');
            return;
        }

        // Update the quantity and stock
        cartItem.quantity = newQuantity;
        product.stock -= difference;
        alert('Quantity updated!');
    }
}

// Function to check if user is logged in
function isLoggedIn() {
    // Placeholder for actual login check logic
    return true; // Change this based on your login implementation
}
